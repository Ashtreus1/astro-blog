import{j as a}from"./jsx-runtime.D_zvdyIk.js";import{r as n}from"./index.DH0ko44-.js";import{M as d}from"./MessageBox.YTdtkdn0.js";import{s as o}from"./supabaseClient.-23kbNNv.js";function f({ticket:s}){const[m,r]=n.useState([]);n.useEffect(()=>{o.from("messages").select("*").eq("ticket_id",s.id).order("created_at",{ascending:!0}).then(({data:e})=>e&&r(e));const t=o.channel(`messages-${s.id}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"messages",filter:`ticket_id=eq.${s.id}`},e=>r(l=>[...l,e.new])).subscribe();return()=>t.unsubscribe()},[s.id]);const c=t=>r(e=>[...e,t]);return a.jsxs("div",{className:"flex flex-col h-full",children:[a.jsxs("div",{className:"border-b p-4 bg-blue-50",children:[a.jsx("h2",{className:"text-xl font-bold",children:s.name}),a.jsx("p",{className:"text-sm",children:`${s.issue} â€“ ${s.status}`})]}),a.jsx(d,{ticketId:s.id,messages:m,appendMessage:c,senderType:"customer"})]})}export{f as default};
